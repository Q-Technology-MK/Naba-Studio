{% extends "core/base.html" %}
{% load i18n multilang %}

{% block title %}{% t 'nav_faq' %} Â· Naba Studio{% endblock %}

{% block content %}
{% get_current_language as LANGUAGE_CODE %}
<div class="faq-sections-wrapper">
    <div class="faq-sections">
        <section class="faq-section faq-main">
            <div class="faq-heading">
                <p class="eyebrow">{% t 'nav_faq' %}</p>
            </div>

            <!-- Category Filter Buttons -->
            {% if faq_categories %}
            <nav class="faq-navigation">
                <ul class="faq-nav-list">
                    {% for category, data in faq_categories.items %}
                    <li>
                        <button type="button" class="faq-nav-link faq-filter-btn{% if forloop.first %} active{% endif %}" data-category="{{ data.key }}">{{ category }}</button>
                    </li>
                    {% endfor %}
                </ul>
            </nav>
            {% endif %}

            <!-- FAQ Items Grouped by Category (initially only first category visible) -->
            {% for category, data in faq_categories.items %}
            <div class="faq-category-group" id="{{ data.key }}" data-category="{{ data.key }}" {% if not forloop.first %}style="display: none;"{% endif %}>
                <h3 class="faq-category-title">{{ category }}</h3>
                <div class="faq-questions">
                    {% for faq in data.faqs %}
                        <details class="faq-line">
                            <summary>
                                {% if LANGUAGE_CODE == 'tr' %}
                                    {{ faq.question_tr }}
                                {% elif LANGUAGE_CODE == 'sq' %}
                                    {{ faq.question_sq }}
                                {% else %}
                                    {{ faq.question_mk }}
                                {% endif %}
                            </summary>
                            <p>
                                {% if LANGUAGE_CODE == 'tr' %}
                                    {{ faq.answer_tr }}
                                {% elif LANGUAGE_CODE == 'sq' %}
                                    {{ faq.answer_sq }}
                                {% else %}
                                    {{ faq.answer_mk }}
                                {% endif %}
                            </p>
                        </details>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </section>

        <div class="faq-accommodation-wrapper">
            {% with background=accommodation_background|default:"https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1600&q=80" %}
            <section
                class="faq-section faq-accommodation"
                style="background-image: url('{{ background }}');"
            >
                <div class="accommodation-content">
                    <h3>{% t 'faq_accommodation' %}</h3>
                    <p>{% t 'faq_book_rooms' %}</p>
                    <a href="{% url 'contacts' %}" class="secondary-btn">{% t 'faq_book_now' %}</a>
                </div>
            </section>
            {% endwith %}
        </div>

    </div>
</div>

<div class="faq-cta-panels">
    <section class="contact-showcase faq-cta">
        <div class="showcase-column image-column">
            {% if faq_cta_left %}
            <img src="{{ faq_cta_left.image.url }}" alt="{{ faq_cta_left.alt_text|default:'Atelier bouquet' }}">
            {% else %}
            <img src="https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=400&q=80" alt="Atelier bouquet">
            {% endif %}
        </div>
        <div class="showcase-column text-column">
            <div class="showcase-text">
                <p class="eyebrow">Naba Studio by Semma</p>
                <h3>{% t 'faq_couture_art' %}</h3>
                <p>{% t 'faq_couture_desc' %}</p>
                <a href="{% url 'contacts' %}" class="showcase-cta">{% t 'services_book_appointment' %}</a>
            </div>
        </div>
        <div class="showcase-column image-column">
            {% if faq_cta_right %}
            <img src="{{ faq_cta_right.image.url }}" alt="{{ faq_cta_right.alt_text|default:'Bridal styling' }}">
            {% else %}
            <img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=400&q=80" alt="Bridal styling">
            {% endif %}
        </div>
    </section>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const filterButtons = document.querySelectorAll('.faq-filter-btn');
    const categoryGroups = document.querySelectorAll('.faq-category-group');
    const faqContainer = document.querySelector('.faq-main');
    
    // Initially show only first category
    categoryGroups.forEach(function(group, index) {
        if (index === 0) {
            group.style.display = 'block';
        } else {
            group.style.display = 'none';
        }
    });
    
    filterButtons.forEach(function(btn) {
        btn.addEventListener('click', function() {
            const selectedCategory = this.getAttribute('data-category');
            
            // Update active button
            filterButtons.forEach(function(b) {
                b.classList.remove('active');
            });
            this.classList.add('active');
            
            // Show only selected category, hide others
            categoryGroups.forEach(function(group) {
                if (group.getAttribute('data-category') === selectedCategory) {
                    group.style.display = 'block';
                } else {
                    group.style.display = 'none';
                }
            });
        });
    });
});
</script>
{% endblock %}
